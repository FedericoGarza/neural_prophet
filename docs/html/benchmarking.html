<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Prediction Collection" href="collect_predictions.html" /><link rel="prev" title="Autoregression" href="autoregression_yosemite_temps.html" />

    <link rel="shortcut icon" href="_static/np_favicon.png"/><meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>Running benchmarking experiments - NeuralProphet documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --font-stack: -apple-system, 'system-ui', 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji';
  --font-stack--monospace: 'SFMono-Regular',Menlo,Consolas,Monaco,Liberation Mono,Lucida Console,monospace;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     
        <a style="text-decoration: none; color: white; font-size: 0,8em" 
           href="https://github.com/ourownstory/neural_prophet/blob/master/notes/NeuralProphet_Facebook_Forecasting_Summit.pdf" target="_blank">
           View NeuralProphet @ Facebook Forecasting Summit!
        </a>
     
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="contents.html"><div class="brand">NeuralProphet  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="contents.html">
    
    <div class="sidebar-logo-container">
      <img class="sidebar-logo" src="_static/np_highres_docs.svg" alt="Logo"/>
    </div>
    <div class="github-button-container">
      <a class="github-button" href="https://github.com/ourownstory/neural_prophet" 
        data-size="large" data-show-count="true" aria-label="Star ourownstory/neural_prophet on GitHub">GitHub
      </a>
    </div>
    

    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    
    
</a> 
<form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="full_simple_model.html">Full Simple Model</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="model-overview.html">Model Overview</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="trend.html">Trend</a></li>
<li class="toctree-l2"><a class="reference internal" href="seasonality.html">Seasonality</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto-regression.html">Auto-regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="lagged-regressors.html">Lagged-regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="future-regressors.html">Future-regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="hyperparameter-selection.html">Hyperparameter-selection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changes-from-prophet.html">Changes from Prophet</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribution</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Feature Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="autoregression_yosemite_temps.html">Autoregression</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Running benchmarking experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="collect_predictions.html">Prediction Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_and_crossvalidate.html">Test and CrossValidate</a></li>
<li class="toctree-l1"><a class="reference internal" href="lagged_covariates_energy_ercot.html">Using Lagged Covariates</a></li>
<li class="toctree-l1"><a class="reference internal" href="events_holidays_peyton_manning.html">Modeling Holidays and Special Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="season_multiplicative_air_travel.html">Multiplicative Seasonality</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse_autoregression_yosemite_temps.html">Sparse Autoregression</a></li>
<li class="toctree-l1"><a class="reference internal" href="sub_daily_data_yosemite_temps.html">Sub-daily data</a></li>
<li class="toctree-l1"><a class="reference internal" href="trend_peyton_manning.html">Fitting a changing trend</a></li>
<li class="toctree-l1"><a class="reference internal" href="global_modeling.html">Global Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Live_plot_during_training.html">Live loss plotting during training</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="energy_hospital_load.html">Building load forecasting: Hospital in SF</a></li>
<li class="toctree-l1"><a class="reference internal" href="energy_solar_pv.html">Renewable Energy: Forecasting hourly solar irradiance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Documentations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="configure.html">configure.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="df_utils.html">df_utils.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="forecaster.html">forecaster.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="hdays.html">hdays.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">metrics.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_forecast.html">plot_forecaster.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_model_parameters.html">plot_model_parameters.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_dataset.html">time_dataset.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_net.html">time_net.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils.py</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<p><a class="reference external" href="https://colab.research.google.com/github/ourownstory/neural_prophet/blob/master/tutorials/feature-use/benchmarking.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a></p>
<section id="Running-benchmarking-experiments">
<h1>Running benchmarking experiments<a class="headerlink" href="#Running-benchmarking-experiments" title="Permalink to this headline">¶</a></h1>
<p>Note: The Benchmarking Framework does currently not properly support auto-regression or lagged covariates with multiple step ahead forecasts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">if</span> <span class="s1">'google.colab'</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">()):</span>
    <span class="o">!</span>pip install git+https://github.com/ourownstory/neural_prophet.git # may take a <span class="k">while</span>
    <span class="c1">#!pip install neuralprophet # much faster, but may not have the latest upgrades/bugfixes</span>

<span class="c1"># we also need prophet for this notebook</span>
<span class="c1"># !pip install prophet</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">neuralprophet</span> <span class="kn">import</span> <span class="n">NeuralProphet</span><span class="p">,</span> <span class="n">set_log_level</span>
<span class="kn">from</span> <span class="nn">neuralprophet.benchmark</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">NeuralProphetModel</span><span class="p">,</span> <span class="n">ProphetModel</span>
<span class="kn">from</span> <span class="nn">neuralprophet.benchmark</span> <span class="kn">import</span> <span class="n">SimpleBenchmark</span><span class="p">,</span> <span class="n">CrossValidationBenchmark</span>
<span class="n">set_log_level</span><span class="p">(</span><span class="s2">"ERROR"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Importing plotly failed. Interactive plots will not work.
INFO - (NP.benchmark.&lt;module&gt;) - Note: The benchmarking framework is not properly documented.Please help us by reporting any bugs and adding documentation.Multiprocessing is not covered by tests and may break on your device.If you use multiprocessing, only run one benchmark per python script.
</pre></div></div>
</div>
<section id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data_location</span> <span class="o">=</span> <span class="s2">"https://raw.githubusercontent.com/ourownstory/neuralprophet-data/main/datasets/"</span>

<span class="n">air_passengers_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_location</span> <span class="o">+</span> <span class="s1">'air_passengers.csv'</span><span class="p">)</span>
<span class="n">peyton_manning_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_location</span> <span class="o">+</span> <span class="s1">'wp_log_peyton_manning.csv'</span><span class="p">)</span>
<span class="c1"># retail_sales_df = pd.read_csv(data_location + 'retail_sales.csv')</span>
<span class="c1"># yosemite_temps_df = pd.read_csv(data_location +  'yosemite_temps.csv')</span>
<span class="c1"># ercot_load_df = pd.read_csv(data_location +  'ERCOT_load.csv')[['ds', 'y']]</span>
</pre></div>
</div>
</div>
</section>
<section id="0.-Configure-Datasets-and-Model-Parameters">
<h2>0. Configure Datasets and Model Parameters<a class="headerlink" href="#0.-Configure-Datasets-and-Model-Parameters" title="Permalink to this headline">¶</a></h2>
<p>First, we define the datasets that we would like to benchmerk on. Next, we define the models that we want to evaluate and set their hyperparameters.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dataset_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Dataset</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">air_passengers_df</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"air_passengers"</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="s2">"MS"</span><span class="p">),</span>
    <span class="c1"># Dataset(df = peyton_manning_df, name = "peyton_manning", freq = "D"),</span>
    <span class="c1"># Dataset(df = retail_sales_df, name = "retail_sales", freq = "D"),</span>
    <span class="c1"># Dataset(df = yosemite_temps_df, name = "yosemite_temps", freq = "5min"),</span>
    <span class="c1"># Dataset(df = ercot_load_df, name = "ercot_load", freq = "H"),</span>
<span class="p">]</span>
<span class="n">model_classes_and_params</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">NeuralProphetModel</span><span class="p">,</span> <span class="p">{</span><span class="s2">"seasonality_mode"</span><span class="p">:</span> <span class="s2">"multiplicative"</span><span class="p">,</span> <span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}),</span>
    <span class="p">(</span><span class="n">ProphetModel</span><span class="p">,</span> <span class="p">{</span><span class="s2">"seasonality_mode"</span><span class="p">:</span> <span class="s2">"multiplicative"</span><span class="p">})</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>Note: As all the classes used in the Benchmark framework are dataclasses, they have a print function, allowing us to peek into them if we like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_classes_and_params</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(neuralprophet.benchmark.NeuralProphetModel,
  {'seasonality_mode': 'multiplicative', 'learning_rate': 0.1}),
 (neuralprophet.benchmark.ProphetModel,
  {'seasonality_mode': 'multiplicative'})]
</pre></div></div>
</div>
</section>
<section id="1.-SimpleBenchmark">
<h2>1. SimpleBenchmark<a class="headerlink" href="#1.-SimpleBenchmark" title="Permalink to this headline">¶</a></h2>
<p>Setting up a series of Train Test Experiments is quick:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">SimpleBenchmark</span><span class="p">(</span>
    <span class="n">model_classes_and_params</span><span class="o">=</span><span class="n">model_classes_and_params</span><span class="p">,</span> <span class="c1"># iterate over this list of tuples</span>
    <span class="n">datasets</span><span class="o">=</span><span class="n">dataset_list</span><span class="p">,</span> <span class="c1"># iterate over this list</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">"MAE"</span><span class="p">,</span> <span class="s2">"MSE"</span><span class="p">,</span> <span class="s2">"MASE"</span><span class="p">,</span> <span class="s2">"RMSE"</span><span class="p">],</span>
    <span class="n">test_percentage</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results_train</span><span class="p">,</span> <span class="n">results_test</span> <span class="o">=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Initial log joint probability = -2.35721
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes
      99       383.095   0.000197806       75.6156     0.07304           1      124
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes
     112       383.482   0.000187545       141.645   1.283e-06       0.001      179  LS failed, Hessian reset
     159       384.105   0.000328631       165.657   3.031e-06       0.001      277  LS failed, Hessian reset
     199       384.233   0.000179066       78.5608      0.4924      0.4924      326
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes
     299       385.249    0.00016096       76.7537      0.2907      0.2907      446
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes
     314       385.282   9.21668e-05       100.953   1.111e-06       0.001      501  LS failed, Hessian reset
     346       385.294   7.66049e-06       75.7986   9.901e-08       0.001      582  LS failed, Hessian reset
     372       385.294    8.2438e-09       78.8225       0.328       0.328      615
Optimization terminated normally:
  Convergence detected: absolute parameter change was below tolerance
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results_test</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>data</th>
<th>model</th>
<th>params</th>
<th>MAE</th>
<th>MSE</th>
<th>MASE</th>
<th>RMSE</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>air_passengers</td>
<td>NeuralProphet</td>
<td>{'seasonality_mode': 'multiplicative', 'learni...</td>
<td>24.027794</td>
<td>795.101013</td>
<td>1.182601</td>
<td>28.197536</td>
</tr>
<tr>
<th>1</th>
<td>air_passengers</td>
<td>Prophet</td>
<td>{'seasonality_mode': 'multiplicative'}</td>
<td>29.818647</td>
<td>1142.139160</td>
<td>1.467615</td>
<td>33.795551</td>
</tr>
</tbody>
</table></div>
</div></div>
</div>
</section>
<section id="2.-CrossValidationBenchmark">
<h2>2. CrossValidationBenchmark<a class="headerlink" href="#2.-CrossValidationBenchmark" title="Permalink to this headline">¶</a></h2>
<p>Setting up a series of crossvalidated experiments is just as simple:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">benchmark_cv</span> <span class="o">=</span> <span class="n">CrossValidationBenchmark</span><span class="p">(</span>
    <span class="n">model_classes_and_params</span><span class="o">=</span><span class="n">model_classes_and_params</span><span class="p">,</span> <span class="c1"># iterate over this list of tuples</span>
    <span class="n">datasets</span><span class="o">=</span><span class="n">dataset_list</span><span class="p">,</span> <span class="c1"># iterate over this list</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">"MASE"</span><span class="p">,</span> <span class="s2">"RMSE"</span><span class="p">],</span>
    <span class="n">test_percentage</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">num_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">fold_overlap_pct</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results_summary</span><span class="p">,</span> <span class="n">results_train</span><span class="p">,</span> <span class="n">results_test</span> <span class="o">=</span> <span class="n">benchmark_cv</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We now also get a summary DataFrame showing the metrics’ mean and standard deviation over all folds.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results_summary</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>data</th>
<th>model</th>
<th>params</th>
<th>MASE</th>
<th>RMSE</th>
<th>MASE_std</th>
<th>RMSE_std</th>
<th>split</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>air_passengers</td>
<td>NeuralProphet</td>
<td>{'seasonality_mode': 'multiplicative', 'learni...</td>
<td>0.280458</td>
<td>7.657820</td>
<td>0.011841</td>
<td>0.713385</td>
<td>train</td>
</tr>
<tr>
<th>1</th>
<td>air_passengers</td>
<td>Prophet</td>
<td>{'seasonality_mode': 'multiplicative'}</td>
<td>0.310869</td>
<td>8.616463</td>
<td>0.021078</td>
<td>1.266764</td>
<td>train</td>
</tr>
<tr>
<th>0</th>
<td>air_passengers</td>
<td>NeuralProphet</td>
<td>{'seasonality_mode': 'multiplicative', 'learni...</td>
<td>0.880757</td>
<td>21.963869</td>
<td>0.244119</td>
<td>5.522509</td>
<td>test</td>
</tr>
<tr>
<th>1</th>
<td>air_passengers</td>
<td>Prophet</td>
<td>{'seasonality_mode': 'multiplicative'}</td>
<td>0.893797</td>
<td>22.778341</td>
<td>0.161704</td>
<td>4.224042</td>
<td>test</td>
</tr>
</tbody>
</table></div>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">air_passengers</span> <span class="o">=</span> <span class="n">results_summary</span><span class="p">[</span><span class="n">results_summary</span><span class="p">[</span><span class="s1">'data'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'air_passengers'</span><span class="p">]</span>
<span class="n">air_passengers</span> <span class="o">=</span> <span class="n">air_passengers</span><span class="p">[</span><span class="n">air_passengers</span><span class="p">[</span><span class="s1">'split'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'test'</span><span class="p">]</span>
<span class="n">plt</span> <span class="o">=</span> <span class="n">air_passengers</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'model'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'RMSE'</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">'barh'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/benchmarking_16_0.png" src="_images/benchmarking_16_0.png"/>
</div>
</div>
<p>The metrics for each fold are also recoreded individually:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results_test</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>data</th>
<th>model</th>
<th>params</th>
<th>MASE</th>
<th>RMSE</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>air_passengers</td>
<td>NeuralProphet</td>
<td>{'seasonality_mode': 'multiplicative', 'learni...</td>
<td>[0.8573083, 0.5941888, 1.1907747]</td>
<td>[20.638454, 15.961023, 29.292131]</td>
</tr>
<tr>
<th>1</th>
<td>air_passengers</td>
<td>Prophet</td>
<td>{'seasonality_mode': 'multiplicative'}</td>
<td>[1.0298454, 0.66658664, 0.9849584]</td>
<td>[24.617702, 16.936632, 26.780687]</td>
</tr>
</tbody>
</table></div>
</div></div>
</div>
</section>
<section id="3.-Manual-Benchmark">
<h2>3. Manual Benchmark<a class="headerlink" href="#3.-Manual-Benchmark" title="Permalink to this headline">¶</a></h2>
<p>If you need more control over the individual Experiments, you can set them up manually:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">neuralprophet.benchmark</span> <span class="kn">import</span> <span class="n">SimpleExperiment</span><span class="p">,</span> <span class="n">CrossValidationExperiment</span>
<span class="kn">from</span> <span class="nn">neuralprophet.benchmark</span> <span class="kn">import</span> <span class="n">ManualBenchmark</span><span class="p">,</span> <span class="n">ManualCVBenchmark</span>
</pre></div>
</div>
</div>
<section id="3.1-ManualBenchmark:-Manual-SimpleExperiment-Benchmark">
<h3>3.1 ManualBenchmark: Manual SimpleExperiment Benchmark<a class="headerlink" href="#3.1-ManualBenchmark:-Manual-SimpleExperiment-Benchmark" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">air_passengers_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_location</span> <span class="o">+</span> <span class="s1">'air_passengers.csv'</span><span class="p">)</span>
<span class="n">peyton_manning_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_location</span> <span class="o">+</span> <span class="s1">'wp_log_peyton_manning.csv'</span><span class="p">)</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"MAE"</span><span class="p">,</span> <span class="s2">"MSE"</span><span class="p">,</span> <span class="s2">"RMSE"</span><span class="p">,</span> <span class="s2">"MASE"</span><span class="p">,</span> <span class="s2">"RMSSE"</span><span class="p">,</span> <span class="s2">"MAPE"</span><span class="p">,</span> <span class="s2">"SMAPE"</span><span class="p">]</span>
<span class="n">experiments</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">SimpleExperiment</span><span class="p">(</span>
        <span class="n">model_class</span><span class="o">=</span><span class="n">NeuralProphetModel</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"seasonality_mode"</span><span class="p">:</span> <span class="s2">"multiplicative"</span><span class="p">,</span> <span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">air_passengers_df</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"air_passengers"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"MS"</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
        <span class="n">test_percentage</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SimpleExperiment</span><span class="p">(</span>
        <span class="n">model_class</span><span class="o">=</span><span class="n">ProphetModel</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"seasonality_mode"</span><span class="p">:</span> <span class="s2">"multiplicative"</span><span class="p">,</span> <span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">air_passengers_df</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"air_passengers"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"MS"</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
        <span class="n">test_percentage</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SimpleExperiment</span><span class="p">(</span>
        <span class="n">model_class</span><span class="o">=</span><span class="n">NeuralProphetModel</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">peyton_manning_df</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"peyton_manning"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"D"</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
        <span class="n">test_percentage</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">SimpleExperiment</span><span class="p">(</span>
        <span class="n">model_class</span><span class="o">=</span><span class="n">ProphetModel</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">peyton_manning_df</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"peyton_manning"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"D"</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
        <span class="n">test_percentage</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">]</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">ManualBenchmark</span><span class="p">(</span>
    <span class="n">experiments</span><span class="o">=</span><span class="n">experiments</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results_train</span><span class="p">,</span> <span class="n">results_test</span> <span class="o">=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results_test</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>data</th>
<th>model</th>
<th>params</th>
<th>MAE</th>
<th>MSE</th>
<th>RMSE</th>
<th>MASE</th>
<th>RMSSE</th>
<th>MAPE</th>
<th>SMAPE</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>air_passengers</td>
<td>NeuralProphet</td>
<td>{'seasonality_mode': 'multiplicative', 'learni...</td>
<td>24.005142</td>
<td>793.559387</td>
<td>28.170187</td>
<td>1.181486</td>
<td>1.090349</td>
<td>5.773936</td>
<td>2.777174</td>
</tr>
<tr>
<th>1</th>
<td>air_passengers</td>
<td>Prophet</td>
<td>{'seasonality_mode': 'multiplicative'}</td>
<td>29.818647</td>
<td>1142.139160</td>
<td>33.795551</td>
<td>1.467615</td>
<td>1.308083</td>
<td>7.471930</td>
<td>3.558547</td>
</tr>
<tr>
<th>2</th>
<td>peyton_manning</td>
<td>NeuralProphet</td>
<td>{'learning_rate': 0.1}</td>
<td>0.575561</td>
<td>0.446854</td>
<td>0.668472</td>
<td>1.870918</td>
<td>1.411006</td>
<td>7.394003</td>
<td>3.551846</td>
</tr>
<tr>
<th>3</th>
<td>peyton_manning</td>
<td>Prophet</td>
<td>{}</td>
<td>0.597307</td>
<td>0.465471</td>
<td>0.682255</td>
<td>1.941605</td>
<td>1.440099</td>
<td>7.704831</td>
<td>3.697093</td>
</tr>
</tbody>
</table></div>
</div></div>
</div>
</section>
<section id="3.2-ManualCVBenchmark:-Manual-CrossValidationExperiment-Benchmark">
<h3>3.2 ManualCVBenchmark: Manual CrossValidationExperiment Benchmark<a class="headerlink" href="#3.2-ManualCVBenchmark:-Manual-CrossValidationExperiment-Benchmark" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">air_passengers_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_location</span> <span class="o">+</span> <span class="s1">'air_passengers.csv'</span><span class="p">)</span>
<span class="n">experiments</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">CrossValidationExperiment</span><span class="p">(</span>
        <span class="n">model_class</span><span class="o">=</span><span class="n">NeuralProphetModel</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"seasonality_mode"</span><span class="p">:</span> <span class="s2">"multiplicative"</span><span class="p">,</span> <span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">air_passengers_df</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"air_passengers"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"MS"</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
        <span class="n">test_percentage</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">num_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">fold_overlap_pct</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">CrossValidationExperiment</span><span class="p">(</span>
        <span class="n">model_class</span><span class="o">=</span><span class="n">ProphetModel</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"seasonality_mode"</span><span class="p">:</span> <span class="s2">"multiplicative"</span><span class="p">,</span> <span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">air_passengers_df</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"air_passengers"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"MS"</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
        <span class="n">test_percentage</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">num_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">fold_overlap_pct</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">]</span>
<span class="n">benchmark_cv</span> <span class="o">=</span> <span class="n">ManualCVBenchmark</span><span class="p">(</span>
    <span class="n">experiments</span><span class="o">=</span><span class="n">experiments</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results_summary</span><span class="p">,</span> <span class="n">results_train</span><span class="p">,</span> <span class="n">results_test</span> <span class="o">=</span> <span class="n">benchmark_cv</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results_summary</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>data</th>
<th>model</th>
<th>params</th>
<th>MAE</th>
<th>MSE</th>
<th>RMSE</th>
<th>MASE</th>
<th>RMSSE</th>
<th>MAPE</th>
<th>SMAPE</th>
<th>MAE_std</th>
<th>MSE_std</th>
<th>RMSE_std</th>
<th>MASE_std</th>
<th>RMSSE_std</th>
<th>MAPE_std</th>
<th>SMAPE_std</th>
<th>split</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>air_passengers</td>
<td>NeuralProphet</td>
<td>{'seasonality_mode': 'multiplicative', 'learni...</td>
<td>5.996241</td>
<td>59.247303</td>
<td>7.662074</td>
<td>0.281055</td>
<td>0.279981</td>
<td>3.043633</td>
<td>1.511519</td>
<td>0.633657</td>
<td>10.927888</td>
<td>0.734798</td>
<td>0.012510</td>
<td>0.013638</td>
<td>0.079835</td>
<td>0.040635</td>
<td>train</td>
</tr>
<tr>
<th>1</th>
<td>air_passengers</td>
<td>Prophet</td>
<td>{'seasonality_mode': 'multiplicative'}</td>
<td>6.655735</td>
<td>75.848122</td>
<td>8.616463</td>
<td>0.310869</td>
<td>0.313269</td>
<td>3.089578</td>
<td>1.553327</td>
<td>0.952938</td>
<td>20.968357</td>
<td>1.266764</td>
<td>0.021078</td>
<td>0.023619</td>
<td>0.261420</td>
<td>0.132790</td>
<td>train</td>
</tr>
<tr>
<th>0</th>
<td>air_passengers</td>
<td>NeuralProphet</td>
<td>{'seasonality_mode': 'multiplicative', 'learni...</td>
<td>19.368925</td>
<td>522.388733</td>
<td>22.173418</td>
<td>0.894181</td>
<td>0.802707</td>
<td>4.570522</td>
<td>2.310261</td>
<td>6.710804</td>
<td>258.608643</td>
<td>5.543307</td>
<td>0.240341</td>
<td>0.144602</td>
<td>1.391520</td>
<td>0.738841</td>
<td>test</td>
</tr>
<tr>
<th>1</th>
<td>air_passengers</td>
<td>Prophet</td>
<td>{'seasonality_mode': 'multiplicative'}</td>
<td>19.052099</td>
<td>536.695312</td>
<td>22.778341</td>
<td>0.893797</td>
<td>0.835219</td>
<td>4.604149</td>
<td>2.272174</td>
<td>3.876074</td>
<td>182.404541</td>
<td>4.224042</td>
<td>0.161704</td>
<td>0.157025</td>
<td>0.710556</td>
<td>0.353903</td>
<td>test</td>
</tr>
</tbody>
</table></div>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="collect_predictions.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Prediction Collection</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="autoregression_yosemite_temps.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Autoregression</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Oskar Triebe |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="_sources/benchmarking.nblink.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Running benchmarking experiments</a><ul>
<li><a class="reference internal" href="#Load-data">Load data</a></li>
<li><a class="reference internal" href="#0.-Configure-Datasets-and-Model-Parameters">0. Configure Datasets and Model Parameters</a></li>
<li><a class="reference internal" href="#1.-SimpleBenchmark">1. SimpleBenchmark</a></li>
<li><a class="reference internal" href="#2.-CrossValidationBenchmark">2. CrossValidationBenchmark</a></li>
<li><a class="reference internal" href="#3.-Manual-Benchmark">3. Manual Benchmark</a><ul>
<li><a class="reference internal" href="#3.1-ManualBenchmark:-Manual-SimpleExperiment-Benchmark">3.1 ManualBenchmark: Manual SimpleExperiment Benchmark</a></li>
<li><a class="reference internal" href="#3.2-ManualCVBenchmark:-Manual-CrossValidationExperiment-Benchmark">3.2 ManualCVBenchmark: Manual CrossValidationExperiment Benchmark</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/main.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    </body>
</html>